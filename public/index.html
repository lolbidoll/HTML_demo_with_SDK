<!-- index.html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leanplum JavaScript Setup with Push Notifications</title>
    <!-- Import LP js files -->
    <script src="https://cdn.jsdelivr.net/npm/leanplum-sdk@1.11.0/dist/leanplum.min.js"></script>
    <script type="text/javascript" src="leanplum.js"></script>
    <script type="text/javascript" src="leanplum.min.js"></script>
    <script type="text/javascript" src="clevertap_sw.js"></script>
    <!--Clevertap Code-->
    <script type="text/javascript">
      var clevertap = {event:[], profile:[], account:[], onUserLogin:[], notifications:[], privacy:[]};
  // replace with the CLEVERTAP_ACCOUNT_ID with the actual ACCOUNT ID value from your Dashboard -> Settings page
 clevertap.account.push({"id": "679-R87-876Z"});
 clevertap.privacy.push({optOut: false}); //set the flag to true, if the user of the device opts out of sharing their data
 clevertap.privacy.push({useIP: false}); //set the flag to true, if the user agrees to share their IP data
  (function () {
          var wzrk = document.createElement('script');
          wzrk.type = 'text/javascript';
          wzrk.async = true;
          wzrk.src = ('https:' == document.location.protocol ? 'https://d2r1yp2w7bby2u.cloudfront.net' : 'http://static.clevertap.com') + '/js/clevertap.min.js';        
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(wzrk, s);
   })();
   console.log("CT connected");
   clevertap.spa = true
 </script>
 

 <script>
  clevertap.notifications.push({
  "titleText":'Would you like to receive Push Notifications?',
  "bodyText":'We promise to only send you relevant content and give you updates on your transactions',
  "okButtonText":'Sign me up!',
  "rejectButtonText":'No thanks',
  "okButtonColor":'#f28046'});
</script>


</head>
<body>

    <h1>Test Web Notification</h1>

    <button onclick="myFunction()">Click me</button>
    <button onclick="myaFunction()">ScreenView</button>
    <!-- Add a div to display the message -->
    <div id="message"></div>

   <!-- Below firebase code is not related to wrapper SDK, you can skip it -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyDizRB3IPW2dZzm00zXcOlXPhq6WnbwGOA",
          authDomain: "webapp-5a8eb.firebaseapp.com",
          projectId: "webapp-5a8eb",
          storageBucket: "webapp-5a8eb.appspot.com",
          messagingSenderId: "556598264182",
          appId: "1:556598264182:web:5400bab6625596bab9fa57"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
      </script>

<script>
    function myFunction() {
       // Leanplum.setUserId("WebUser34");
        clevertap.onUserLogin.push({
 "Site": {
   "Name": "Jack Montana",            // String
   "Identity": "WebUser34",              // String or number
 }
})
        console.log("User sent to LP");
    }
    </script>
    <script>
      function myaFunction() {
          // Tracks view cart event for a user.
          clevertap.event.push("ScreenView");
      }
      </script>


    <!-- Initialize Leanplum -->
    <script>

      // This value should be set to true only if you're developing on your server.
var isDevelopmentMode = true;

// Sample variables. This can be any JSON object.
var variables = {
 items: {
   color: 'red',
   size: 20,
   showBadges: true
 },
 showAds: true
};

// Get your App ID and Keys from https://www.leanplum.com/dashboard?#/account/apps
if (isDevelopmentMode) {
 Leanplum.setAppIdForDevelopmentMode("app_VA4XP05hxW5BAtrMTOlSNmxQP9k5L8S40JfgSdtNvbM", "dev_SDJoM6YBvSPpPqN8SrUV3n2nUkuO9entbAMUNTlCWeU");

} else {
 Leanplum.setAppIdForProductionMode("YOUR_APP_ID", "YOUR_PRODUCTION_KEY");
}

Leanplum.setVariables(variables);
Leanplum.start(function(success) {
 console.log('Success: ' + success);
 console.log('Variables', Leanplum.getVariables());
});
    </script>

<!-

    <script>
      function requestNotificationPermission() {
    Notification.requestPermission().then(permission => {
        if (permission === 'granted') {
            console.log('Notification permission granted.');
            // Proceed with subscribing to push notifications
            Leanplum.registerForWebPush('clevertap_sw').then(subscriptionStatus => {
                console.log('Subscription status: %s', subscriptionStatus);
            });
        } else {
            console.log('Notification permission denied.');
        }
    });
}

// Call this function where appropriate in your code
requestNotificationPermission();

    </script>

<!--
    <script>

let isSubscribedToWebPush = true;
let isWebPushSupported = Leanplum.isWebPushSupported();

  Leanplum.isWebPushSubscribed().then(subscriptionStatus => {
      isSubscribedToWebPush = subscriptionStatus;
      console.log('Success: Subscribed for Notifications');
  });

//Once validated, you can register the device for push:

  // Register by passing SW filepath (which is in our root directory).
  Leanplum.registerForWebPush('clevertap_sw.js').then(subscriptionStatus => {
    console.log('Subscription status: %s', subscriptionStatus);
  });
    </script>
-->
</body>
</html>
